- **主题词**是由机构定义和发布的规范词, 通常是专有名词或名词短语
  - 主题词检索结果包括检索词的近义词, 同义词以及同一概念词的不同书写形式等
  - 通过主题词检索可以很大程度降低漏检和误检
- **关键词**通过自定义或自动分析提取, 通常是可以高度概括该文章主题的
  - 使用关键词搜索可搜出更加明确的主题方向的文章

对于知识文档, 提取其中的主题词/关键词, 建立索引, 作为检索的入口. 对于用户的 query, 提取主题词/关键词, 作为语义槽的内容. 可以通过精确匹配, 或者使用关键词的 embedding 进行检索召回.

![](/resources/images/llm/rag-4.png)

# 关键词提取

从无标注文本是实现信息抽取(Information Extraction, IE), 包含三类任务:

- 命名实体识别(NER, Name-Entity Recognition). 指的是可以用专有名词标识的事物, 一个命名实体一般代表唯一一个具体事物个体
- 实体关系三元组抽取(RE, Relation Extraction). 关系抽取，即(主体, 关系, 客体)实体三元组抽取. 涉及两件事:
  - 识别文本中的主体、客体, 即实体识别任务
  - 判断这两个实体属于哪种关系, 即关系分类
- 事件抽取(EE, Event Extraction). 事件抽取就是从半结构化, 非结构化数据中, 识别一个与目标相关的事件的重要元素. 从自然语言角度通过`主谓宾`等语义单元体现

将上述三类任务简化为两个过程:

1. 名词短语提取, 即主语、宾语. 通常由名词, 和名词的限定词或者修饰词组成
2. 谓语, 体现名词短语之间的事件. 可能是比较、查询、过滤、统计等

而关键词**只考虑名词短语**, 将其作为知识点的索引用于召回. 这是因为知识点通常不是按照事件组织的, 而是实体. 因此索引建立和关键词抽取, 应该以名词短语为主要目标.

主语、宾语之间存在并列和限定关系, 获取主语、宾语对应的语料后, 通过 LLM 理解事件关系进行处理:

- 将限定关系按级联方式处理
- 同一名词短语内如果存在并列关系则与其他部分叉乘

以 `姚明和奥尼尔的内线与三分能力` 这句 query 为例, 可以提取出`姚明`, `奥尼尔`, 以及`内线能力`, `三分能力`四个关键词, 其中`姚明`, `奥尼尔`为并列关系, `内线能力`, `三分能力`也是并列关系, [`姚明`, `奥尼尔`] 和 [`内线能力`, `三分能力`] 有级联关系. 经过叉乘和级联处理后, 可以得到下面的关键词:

- 姚明内线
- 姚明三分
- 奥尼尔内线
- 奥尼尔三分

## 基于传统 NLP 的关键词提取

实现上面这种**多知识点聚合查询问题**的关键词提取, 需要借助传统的 NLP 能力: 分词, 词性标注, NER, 依存关系等. 其核心点在于三步:

- 词性标注
- 名词短语关系分析: 修饰、限定、并列等
- 名词短语重新组织: 修饰、限定关系级联; 并列关系与其他部分叉乘

对下面的句子首先进行分词和词性标注, 得到如下的结果:

![](/resources/images/llm/rag-5.png)

然后进行**依存句法分析**和**语义依存分析**, 进一步提取句子中单词与单词之间的语法关系. 采取Stanford Dependencies Chinese(SDC)标准进行分析. 结果如下:

![](/resources/images/llm/rag-6.png)

- dep_tok_id: 表示当前分词所依赖的中心词的 ID. 比如`指导`的中心词 ID 是 5
- dep_rel: 表示当前分词和中心词的关系. 比如: `指导`和中心词`主席`的关系是 `conj`, 根据 SDC 标准其含义为 `连接`，即指导和主席属于并列关系. 类似的, `詹姆斯`、`约基奇`和`张伯伦`都属于并列关系, 但是`张伯伦`的中心词是`能力`, 关系为 `assmod`, 即关联关系(修饰限定)
- sdp_tok_ids 和 sdp_rel: 是在依存句法分析的基础上进一步提供**语义依存分析**, 旨在分析一个句子中单词与单词之间的语义关系(sdp_rel). 不同于依存句法分析的地方是, 语义分析的结果是图结构, 图结构中每个节点可以有任意个目标节点. 需要特别关心的是: Agt(施事者), Poss(领事者), eCoo(并列关系)等

根据上面的依赖关系结果, 可以获取到如下的名词短语:

- 主体: 并列关系: `[张指导, 姚主席]`
- 客体: `[三分能力]`, 三分和能力是修饰关系
- 客体还存在三个并列的领事关系(所属关系): `[詹姆斯, 约基奇, 张伯伦]`
- 所以实际的客体, **应该将并列的领事关系和本体叉乘后平铺**, 结果就是: `[詹姆斯三分能力, 约基奇三分能力, 张伯伦三分能力]`

用这三个关键词, 将关键词 Embedding 后去本地知识库搜索就可大大提升命中精度.
