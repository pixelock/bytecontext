实际工作中, 我们常常会遇到训练集数据可能存在标注质量问题, 或者是数据标注质量不过关, 或者是数据标注的标准不统一, 存在一些歧义.

需要将这些标注错误的样本找出来, 重新标注或者剔除. 手动寻找要面对大量的数据, 耗时耗力, 需要通过一些方法缩小筛选的范围, 使得人工清洗成为可能.

更好的方式是可以自动地找出有问题的样本.

# 缩小问题样本的范围

## 多折交叉验证

在训练集使用 K-fold, 训练多个模型, 然后每一个 fold 在剩余的训练集上进行预测. 预测结果与标注结果不同的样本, 做为筛选后有问题的候选问题样本集. 这部分错误的原因可能是由于标注错误, 或者是 hard negatives. 因此不能直接抛弃, 而是需要使用人工再标注.

这种方法能大大缩小要检查的样本数量, 提高迭代的效率.

# 自动发现问题样本

自动发现问题样本, 然后直接舍弃样本的方式, 多少都会把 hard negatives 抛弃掉, 导致模型的能力受到影响(只能学习到简单样本). 所以需要根据实际情况, 在数据质量和模型能力之间做权衡.

一般来说, 如果数据集的样本量够大, 使用剔除的方法比较好. 在小样本集上, 还是不要直接提出, 用上面筛选去这个候选问题样本, 然后用人工校验的方式比较好.

## 置信学习

在 [Confident Learning: Estimating Uncertainty in Dataset Labels](https://arxiv.org/abs/1911.00068) 论文中, 提出了置信学习(Confident Learning, CL), 以识别标签错误, 表征标签噪声并应用于带噪学习(noisy label learning).

一个完整的置信学习框架, 需要完成以下三个步骤:

![](/resources/images/nn/cl-1.png)

1. **Count**: 估计噪声标签和真实标签的联合分布
2. **Clean**: 找出并过滤掉错误样本
3. **Re-Training**: 过滤错误样本后, 重新调整样本类别权重, 重新训练

具体的原理参考这篇文章: [标注数据存在错误怎么办？MIT&Google提出用置信学习找出错误标注（附开源实现）](https://zhuanlan.zhihu.com/p/146557232)

通过交叉验证(K-fold)得到每个样本在每个类别下的概率, 通过统计的方法, 计算每个类别下的平均概率, 作为这个类别的置信度阈值, 只有一个样本最大概率为对应的类别超过这个类的置信度阈值, 才认为是真实标签.

基于上面方法得到的"真实标签", 和原本的噪音标签一起, 得到混淆矩阵. 基于混淆矩阵, 再求得两个标签的联合分布, 结合不同的过滤策略, 剔除掉有问题的样本.

例如有以下 5 种剔除方法:

![](/resources/images/nn/cl-2.png)

- Method 1, 就是去掉预测和标注不一样的样
- Method 2, 就是去掉预测小于每个类别平均预测概率的样本

# 参考

- [标注数据存在错误怎么办？MIT&Google提出用置信学习找出错误标注（附开源实现）](https://zhuanlan.zhihu.com/p/146557232)
